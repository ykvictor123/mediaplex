<html><head><base href="https://www.flixhub.com">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alisson Movies - Streaming Movies and TV Shows</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom, #000000, #1a1a1a 50%);
      background-attachment: fixed;
      color: #fff;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    header {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 30px;
    }
    .header-top {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      margin-bottom: 20px;
    }
    .logo {
      margin-right: 10px;
      animation: spin 10s linear infinite;
    }
    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
        opacity: 1;
      }
      50% {
        transform: scale(1.1);
        opacity: 0.7;
      }
    }
    @keyframes colorShift {
      0%, 100% {
        filter: hue-rotate(0deg);
      }
      50% {
        filter: hue-rotate(30deg);
      }
    }
    .logo .pulse {
      animation: pulse 2s ease-in-out infinite;
    }
    .logo:hover {
      animation: spin 5s linear infinite, colorShift 3s alternate infinite;
    }
    h1 {
      background: linear-gradient(to right, #8B0000, #FF3333);
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
      font-weight: bold;
      padding: 10px 0;
    }
    nav {
      display: flex;
      flex-direction: column;
      width: 100%;
      align-items: center;
      margin-top: 20px;
    }
    .nav-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin: 20px 0;
    }
    .nav-buttons button {
      background: rgba(51, 51, 51, 0.8);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s ease;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .nav-buttons button:hover {
      background: rgba(77, 77, 77, 0.9);
    }
    .nav-buttons button.active {
      background: #e50914;
    }
    .language-toggle {
      background-color: transparent !important;
      border: 1px solid #fff !important;
      color: #fff;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 25px;
    }
    .search-container {
      display: flex;
      margin-bottom: 30px;
      align-items: center;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 25px;
      padding: 0;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      height: 50px; 
      position: relative;
    }
    #searchInput {
      flex-grow: 1;
      padding: 0 20px;
      font-size: 1rem;
      border: none;
      background: transparent;
      color: #fff;
      outline: none;
      height: 100%; 
      border-radius: 25px 0 0 25px;
    }
    #searchInput::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }
    #searchInput:focus {
      box-shadow: 0 0 0 2px rgba(229,9,20,0.5);
      background: rgba(255,255,255,0.15);
    }
    #searchInput:focus::placeholder {
      color: rgba(255,255,255,0.3);
    }
    #searchButton {
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(to right, #8B0000, #FF0000);
      color: #fff;
      border: none;
      padding: 0 25px;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 0 25px 25px 0;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      margin-left: 0;
      height: 100%;
      width: 100px; 
    }
    #searchButton:hover {
      background: linear-gradient(to right, #A00000, #FF3333);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    .media-section {
      margin-bottom: 40px;
    }
    .category-section {
      margin-bottom: 40px;
    }
    .category-section .category-title {
      font-size: 1.8em;
      color: white;
      margin: 0 0 20px 0;
      padding: 15px;
      border-left: 4px solid #e50914;
      background: rgba(229,9,20,0.1);
      border-radius: 0 8px 8px 0;
    }
    .movies-section, .tv-section {
      margin-top: 30px;
    }
    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
      padding: 20px 0;
    }
    .rating-badge, .media-year {
      position: absolute;
      background: rgba(0, 0, 0, 0.8);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      z-index: 2;
      color: white;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .rating-badge {
      top: 10px;
      left: 10px;
      color: #ffd700;
      display: flex;
      align-items: center;
      gap: 3px;
    }
    .media-year {
      top: 10px;
      right: 10px;
    }
    .media-item {
      position: relative;
      width: 100%;
      aspect-ratio: 2/3;
      border-radius: 8px;
      overflow: hidden;
      transition: transform 0.2s ease;
      cursor: pointer;
    }
    .media-item:hover {
      transform: scale(1.05);
    }
    .media-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 8px;
      transition: transform 0.3s ease;
    }
    .media-item:hover .rating-badge,
    .media-item:hover .media-year {
      opacity: 1;
    }
    .media-title {
      margin: 0;
      font-size: 0.9rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 60px; 
    }
    .media-rating {
      font-size: 0.8rem;
      color: #ffd700;
      margin: 3px 0;
    }
    .media-details {
      font-size: 0.7rem;
      margin: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 1001;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
    }
    .modal-content {
      background-color: #232323;
      margin: 5% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 800px;
      border-radius: 5px;
      color: #fff;
    }
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }
    .close:hover,
    .close:focus {
      color: #fff;
      text-decoration: none;
      cursor: pointer;
    }
    .video-container {
      position: relative;
      padding-bottom: 56.25%; 
      height: 0;
      background: #000;
    }
    #player {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
    }
    #subtitlesOverlay {
      position: absolute;
      bottom: 50px;
      left: 0;
      right: 0;
      text-align: center;
      color: #fff;
      font-size: 20px;
      text-shadow: 0 0 3px #000;
      z-index: 1000;
      pointer-events: none;
    }
    #mediaInfo {
      margin-top: 20px;
      padding: 20px;
      background-color: #333;
      border-radius: 5px;
    }
    #seasonEpisodeSelection {
      margin: 10px 0;
      padding: 10px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 5px;
    }
    #seasonEpisodeSelection select {
      margin: 0 10px;
      padding: 5px 10px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 3px;
    }
    .side-menu {
      position: fixed;
      top: 0;
      right: -300px;
      width: 300px;
      height: 100vh;
      background-color: #232323;
      padding: 20px;
      transition: right 0.3s ease;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: -2px 0 5px rgba(0, 0, 0, 0.3);
      visibility: hidden;  
    }
    .side-menu.open {
      right: 0;
      visibility: visible;
      height: 100vh; 
      overflow-y: auto; 
    }
    .side-menu form > * {
      margin-bottom: 15px;
    }
    .side-menu select,
    .side-menu input {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      background-color: #333;
      border: 1px solid #444;
      color: white;
    }
    .side-menu input[type="radio"] {
      width: auto;
    }
    footer {
      text-align: center;
      padding: 20px 0;
      color: #fff;
      font-size: 14px;
      font-weight: bold;
    }
    :root {
      --width: 200px;
      --ani-speed: 60s;
      --ani-offset: calc(-100% - var(--width));
    }
    .carousel-section {
      overflow: hidden;
      margin: 20px 0;
    }
    .carousel-wrapper {
      position: relative;
      width: 100%;
      overflow: hidden;
    }
    .carousel-wrapper::before,
    .carousel-wrapper::after {
      content: '';
      position: absolute;
      top: 0;
      width: 100px;
      height: 100%;
      z-index: 2;
    }
    .carousel-wrapper::before {
      left: 0;
      background-image: linear-gradient(to right, rgba(20, 20, 20, 0.8) 0%, transparent 100%);
      pointer-events: none;
    }
    .carousel-wrapper::after {
      right: 0;
      background-image: linear-gradient(to left, rgba(20, 20, 20, 0.8) 0%, transparent 100%);
      pointer-events: none;
    }
    .carousel {
      display: flex;
      align-items: center;
      animation: slide var(--ani-speed) linear infinite;
      will-change: transform;
    }
    .carousel .item {
      flex: 1 0 var(--width);
      text-align: center;
      padding: 1rem;
      box-sizing: border-box;
      position: relative;
    }
    .carousel .item > img {
      width: 100%;
      height: auto;
      object-fit: cover;
      border-radius: 5px;
      transition: transform 0.3s ease;
    }
    .carousel .item:hover > img {
      transform: scale(1.05);
    }
    .carousel-indicator {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.8);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 16px;
    }
    @keyframes slide {
      100% {
        transform: translateX(var(--ani-offset));
      }
    }
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 999;
    }
    .rating-badge {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0, 0, 0, 0.8);
      color: #ffd700; 
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      z-index: 2;
      display: flex;
      align-items: center;
      gap: 3px;
    }
    .similar-media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .similar-item {
      position: relative;
      width: 100%;
      aspect-ratio: 2/3;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .similar-item:hover {
      transform: scale(1.05);
    }
    .similar-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 4px;
    }
    .similar-item p {
      margin: 5px 0;
      font-size: 14px;
      text-align: center;
    }
    .age-rating {
      display: inline-block;
      background: #333;
      padding: 4px 8px;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .play-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
    }
    .play-buttons button {
      flex: 1;
      min-width: 200px;
      padding: 12px 20px;
      font-size: 15px;
      font-weight: 500;
      background: linear-gradient(to right, #e50914, #db0510);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(229, 9, 20, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .play-buttons button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(229, 9, 20, 0.3);
      background: linear-gradient(to right, #f40612, #e50914);
    }
    .trailer-button {
      background: linear-gradient(to right, #FFD700, #FFA500) !important;
      color: #000 !important;
      font-weight: bold;
    }
    .trailer-button:hover {
      background: linear-gradient(to right, #FFA500, #FF8C00) !important;
    }
    .media-year {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      z-index: 2;
    }
    .media-details-info {
      background: rgba(0, 0, 0, 0.2);
      padding: 15px;
      border-radius: 5px;
      margin: 15px 0;
    }
    .media-details-info p {
      margin: 5px 0;
    }
    .media-details-info strong {
      color: #e50914;
    }
    .back-button {
      background: transparent;
      border: 1px solid #fff;
      color: #fff;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin-bottom: 15px;
      transition: all 0.3s ease;
    }
    .back-button:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    .similar-item .media-info {
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .similar-item:hover .media-info {
      opacity: 1;
    }
    .categories-section {
      margin: 20px 0;
      padding: 10px;
    }
    .category-header {
      padding: 15px 0; 
      margin-bottom: 15px; 
      border-bottom: 2px solid rgba(229,9,20,0.3);
    }
    .category-title {
      font-size: 1.8em;
      color: white;
      margin: 0;
      padding-left: 15px;
      border-left: 4px solid #e50914;
    }
    .category-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); 
      gap: 10px; /* Reduce gap between cards */
      padding: 10px 0;
    }
    .category-card {
      position: relative;
      height: 120px; /* Reduce the height */
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    .category-background {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-size: cover;
      background-position: center;
      transform: scale(1.1);
      transition: transform 0.3s ease;
    }
    .category-backdrop {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, rgba(0,0,0,0.8), rgba(0,0,0,0.4));
      transition: background 0.3s ease;
    }
    .category-card:hover .category-background {
      transform: scale(1.2);
    }
    .category-card:hover .category-backdrop {
      background: linear-gradient(45deg, rgba(229,9,20,0.8), rgba(229,9,20,0.4));
    }
    .category-content {
      position: relative;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px; /* Reduce padding */
      text-align: center;
      z-index: 2;
    }
    .category-icon {
      font-size: 1.8em; /* Reduce icon size */
      margin-bottom: 8px; 
      transition: transform 0.3s ease;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
    }
    .category-content h3 {
      margin: 0;
      font-size: 1em; /* Reduce font size */
      font-weight: 600;
      color: white;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
      transform: translateY(0);
      transition: transform 0.3s ease;
    }
    .carousel .item {
      position: relative;
    }
    .carousel .item .rating-badge {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 3;
    }
    .trailer-button {
      background: linear-gradient(to right, #FFD700, #FFA500) !important;
      color: #000 !important;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .trailer-button:hover {
      background: linear-gradient(to right, #FFA500, #FF8C00) !important;
      transform: scale(1.05);
    }
    .play-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
    }
    .category-filter {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 20px;
    }
    .filter-btn {
      background: linear-gradient(to bottom, #808080, #404040);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .filter-btn:hover {
      background: linear-gradient(to bottom, #909090, #505050);
      transform: translateY(-2px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    .filter-btn.active {
      background: linear-gradient(to bottom, #e50914, #b20710);
      box-shadow: 0 2px 8px rgba(229, 9, 20, 0.3);
    }
    .loading, .error {
      padding: 20px;
      text-align: center;
      width: 100%;
      color: #fff;
    }
    .loading {
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
    }
    .error {
      background: rgba(229,9,20,0.1);
      border-radius: 8px;
      color: #e50914;
    }
    .media-year {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      z-index: 2;
    }
    .player-controls {
      position: absolute;
      bottom: 20px;
      right: 20px;
      z-index: 1001;
    }
    .close-video {
      background: rgba(229, 9, 20, 0.9);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    .close-video:hover {
      background: #e50914;
    }
    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      background: #000;
    }
    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .error {
      color: #e50914;
      padding: 20px;
      text-align: center;
      background: rgba(229, 9, 20, 0.1);
      border-radius: 8px;
    }
    .load-more-container {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    .load-more-button {
      background: linear-gradient(to right, #e50914, #b20710);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(229, 9, 20, 0.3);
    }
    .load-more-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(229, 9, 20, 0.4);
      background: linear-gradient(to right, #f40612, #e50914);
    }
    .load-more-button:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .subtitle-select {
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 8px;
      border-radius: 4px;
      margin: 10px 0;
      width: 200px;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .subtitle-select:focus {
      outline: none;
      border-color: #e50914;
    }
    .subtitles-selection h3 {
      color: #fff;
      margin-bottom: 10px;
    }
    .subtitle-select option {
      background: #232323;
      color: white;
      padding: 8px;
    }
    .video-container .loading,
    .video-container .error {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.8);
      padding: 20px;
      border-radius: 8px;
      z-index: 2;
    }
    .video-container .error {
      color: #e50914;
    }
    .retry-button {
      background: #e50914;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      margin-top: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .retry-button:hover {
      background: #f40612;
    }
    .video-container .error {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 8px;
      text-align: center;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 8px;
      color: white;
      z-index: 2;
    }
    .latino-server {
      background: linear-gradient(to right, #006847, #ce1126) !important;
      color: white !important;
      font-weight: bold;
      border: 2px solid #fcd116;
    }
    .latino-server:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 104, 71, 0.4);
    }
    .similar-content-section {
      margin-top: 30px;
      padding: 20px;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
    }
    .similar-content-section h3 {
      color: #fff;
      margin-bottom: 20px;
      font-size: 1.5em;
      border-left: 4px solid #e50914;
      padding-left: 10px;
    }
    .similar-media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .similar-item {
      position: relative;
      width: 100%;
      aspect-ratio: 2/3;
      cursor: pointer;
      transition: transform 0.3s ease;
      border-radius: 8px;
      overflow: hidden;
    }
    .similar-item:hover {
      transform: scale(1.05);
    }
    .similar-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 8px;
    }
    .similar-item p {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 10px;
      margin: 0;
      background: rgba(0,0,0,0.8);
      color: white;
      font-size: 14px;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-top">
        <svg id="logoHome" class="logo" width="60" height="60" viewBox="0 0 100 100">
          <defs>
            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#e50914"></stop>
              <stop offset="100%" stop-color="#b20710"></stop>
            </linearGradient>
          </defs>
          <circle cx="50" cy="50" r="45" fill="url(#gradient)"></circle>
          <path d="M35 30 L70 50 L35 70 Z" fill="#fff"></path>
          <circle cx="50" cy="50" r="48" fill="none" stroke="#fff" stroke-width="2" class="pulse"></circle>
        </svg>
        <h1 data-translate="FlixHub">Alisson Movies</h1>
      </div>
    </header>

    <div class="search-container">
      <input type="text" id="searchInput" placeholder="Buscar películas o series..." data-translate="Search for movies or TV shows...">
      <button id="searchButton" data-translate="Search">Buscar</button>
    </div>

    <section class="carousel-section">
      <div class="carousel-wrapper">
        <div class="carousel">
          <!-- Carousel items will be dynamically added here -->
        </div>
      </div>
    </section>

    <section class="categories-section">
      <div class="category-header">
        <h2 class="category-title">Categorías</h2>
        <div class="category-filter">
          <button id="movieCategoriesBtn" class="filter-btn active">Películas</button>
          <button id="tvCategoriesBtn" class="filter-btn">Series</button>
        </div>
      </div>
      <div class="category-grid"></div>
    </section>

    <nav class="content-nav">
      <div class="nav-buttons">
        <button id="popularButton" data-translate="Popular">Popular</button>
        <button id="nowPlayingButton" data-translate="Now Playing">Estrenos</button>
        <button id="topRatedButton" data-translate="Top Rated">Mejor Valorados</button>
        <button id="moviesButton" data-translate="Movies">Películas</button>
        <button id="tvShowsButton" data-translate="TV Shows">Series</button>
        <button id="languageToggle" class="language-toggle">ES</button>
      </div>
    </nav>

    <section class="media-section">
      <div id="popularMovies" class="media-grid" style="display: grid; grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(6, auto); gap: 15px;">
        <div class="category-section movies-section" style="grid-column: 1 / -1; grid-row: 1 / 4; display: block;">
          <h2 class="category-title">🎬 Películas</h2>
          <div class="media-grid movies-grid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;"></div>
          <div class="load-more-container">
            <button id="loadMoreMovies" class="load-more-button">Cargar más películas</button>
          </div>
        </div>
        <div class="category-section tv-section" style="grid-column: 1 / -1; grid-row: 4 / 7; display: block;">
          <h2 class="category-title">📺 Series de TV</h2>
          <div class="media-grid tv-grid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;"></div>
          <div class="load-more-container">
            <button id="loadMoreTv" class="load-more-button">Cargar más series</button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <div id="sideMenu" class="side-menu">
    <h2 id="advanced-search" data-translate="Advanced Search">Búsqueda Avanzada</h2>
    
    <label for="country" data-translate="Country">País:</label>
    <select id="country" name="country">
      <option value="" data-translate="All Countries">Todos los Países</option>
    </select>

    <label for="genre" data-translate="Genre">Género:</label>
    <select id="genre" name="genre">
      <option value="" data-translate="All Genres">Todos los Géneros</option>
    </select>

    <label for="yearFrom" data-translate="Year From">Desde el Año:</label>
    <select id="yearFrom" name="yearFrom">
      <option value="">Seleccionar año</option>
    </select>

    <label for="yearTo" data-translate="Year To">Hasta el Año:</label>
    <select id="yearTo" name="yearTo">
      <option value="">Seleccionar año</option>
    </select>

    <label for="rating" data-translate="Minimum Rating">Calificación Mínima:</label>
    <input type="number" id="rating" name="rating" min="0" max="10" step="0.1">

    <label data-translate="Media Type">Tipo de Contenido:</label>
    <div class="radio-group">
      <input type="radio" id="movieType" name="mediaType" value="movie" checked="">
      <label for="movieType" data-translate="Movie">Película</label>
      <input type="radio" id="tvType" name="mediaType" value="tv">
      <label for="tvType" data-translate="TV Show">Serie</label>
    </div>

    <label for="sortBy" data-translate="Sort By">Ordenar Por:</label>
    <select id="sortBy" name="sortBy">
      <option value="popularityDesc" data-translate="Popularity (Descending)">Popularidad (Descendente)</option>
      <option value="ratingDesc" data-translate="Rating (Descending)">Calificación (Descendente)</option>
      <option value="yearDesc" data-translate="Year (Newest First)">Año (Más Reciente)</option>
      <option value="yearAsc" data-translate="Year (Oldest First)">Año (Más Antiguo)</option>
    </select>

    <button type="button" id="advancedSearchButton" data-translate="Search">Buscar</button>
  </div>

  <div id="playerModal" class="modal">
    <div class="modal-content">
      <span class="close">×</span>
      <div id="mediaInfo"></div>
    </div>
  </div>

  <div class="overlay"></div>

  <script>
    function closeModal() {
      const modal = document.getElementById('playerModal');
      const player = document.getElementById('player');
      const mediaInfo = document.getElementById('mediaInfo');
      
      // Clear the video and media info
      if (mediaInfo) {
        mediaInfo.innerHTML = '';
      }
      
      // Reset iframe src to stop video playback
      if (player) {
        player.src = '';
      }
      
      // Hide the modal
      if (modal) {
        modal.style.display = 'none';
      }
      
      // Clear current media state
      currentMediaId = null;
      currentServer = 'latino';
    }

    function closeVideo() {
      const videoContainer = document.querySelector('.video-container');
      if (videoContainer) {
        const player = document.getElementById('player');
        if (player) {
          player.src = ''; // Stop video playback
        }
        // Reset container to empty state
        videoContainer.innerHTML = `
          <iframe id="player" frameborder="0" allowfullscreen></iframe>
          <div class="player-controls">
            <button onclick="closeVideo()" class="close-video">Close Video</button>
          </div>
        `;
      }
    }

    function constructVideoUrl(server, id, type) {
      // Get TV show season and episode if available
      let season = 1;
      let episode = 1;
      const seasonSelect = document.getElementById('seasonSelect');
      const episodeSelect = document.getElementById('episodeSelect');
      
      if (type === 'tv' && seasonSelect && episodeSelect) {
        season = seasonSelect.value;
        episode = episodeSelect.value;
      }

      // Construct URL based on server
      switch (server) {
        case 'latino':
          // Use new PlayHubLite URLs
          return type === 'movie' 
            ? `https://playhublite.com/movies/${id}`
            : `https://playhublite.com/series/${id}-${season}-${episode}`;
        
        case 'server1':
          return type === 'movie'
            ? `https://vidsrc.to/embed/movie/${id}`
            : `https://vidsrc.to/embed/tv/${id}/${season}/${episode}`;
            
        case 'moviesapi':
          return type === 'movie'
            ? `https://multiembed.mov/directstream.php?video_id=${id}&tmdb=1`
            : `https://multiembed.mov/directstream.php?video_id=${id}&tmdb=1&s=${season}&e=${episode}`;
            
        case 'vidsrc':
          return type === 'movie'
            ? `https://vidsrc.me/embed/movie?tmdb=${id}`
            : `https://vidsrc.me/embed/tv?tmdb=${id}&season=${season}&episode=${episode}`;
            
        case 'moviesapiclub':  
          return type === 'movie'
            ? `https://moviesapi.club/movie/${id}`
            : `https://moviesapi.club/tv/${id}/${season}/${episode}`;
            
        case 'vidsrcxyz':
          return type === 'movie'
            ? `https://vidsrc.xyz/embed/movie?tmdb=${id}`
            : `https://vidsrc.xyz/embed/tv?tmdb=${id}&s=${season}&e=${episode}`;
            
        default:
          // Default to server1 if unknown server
          return type === 'movie'
            ? `https://vidsrc.to/embed/movie/${id}`
            : `https://vidsrc.to/embed/tv/${id}/${season}/${episode}`;
      }
    }

    let currentMediaId = null;
    let previousMediaId = null;
    let previousMediaType = null;
    let currentServer = 'latino'; // Default server

    const TMDB_API_KEY = '708a2826cbb3c7dbd79b10c569049f54';
    const TMDB_BASE_URL = 'https://api.themoviedb.org/3';
    const CACHE_DURATION = 96 * 60 * 60 * 1000;

    const OPENSUBTITLES_API_URL = 'https://api.opensubtitles.com/api/v1';
    const OPENSUBTITLES_API_KEY = 'YOUR_OPENSUBTITLES_API_KEY'; // You need to register and get an API key
    const USER_AGENT = 'FlixHub v1.0';

    const MOVIE_GENRES = {
      28: { name: 'Action', icon: '🎬' },
      12: { name: 'Adventure', icon: '🌟' },
      16: { name: 'Animation', icon: '🎨' },
      35: { name: 'Comedy', icon: '😂' },
      80: { name: 'Crime', icon: '🚔' },
      99: { name: 'Documentary', icon: '📚' },
      18: { name: 'Drama', icon: '🎭' },
      10751: { name: 'Family', icon: '👨‍👩‍👧‍👦' },
      14: { name: 'Fantasy', icon: '🧙‍♂️' },
      36: { name: 'History', icon: '📜' },
      27: { name: 'Horror', icon: '👻' },
      10402: { name: 'Music', icon: '🎵' },
      9648: { name: 'Mystery', icon: '🔍' },
      10749: { name: 'Romance', icon: '❤️' },
      878: { name: 'Science Fiction', icon: '🚀' },
      10770: { name: 'TV Movie', icon: '📺' },
      53: { name: 'Thriller', icon: '😱' },
      10752: { name: 'War', icon: '⚔️' },
      37: { name: 'Western', icon: '🤠' }
    };

    const TV_GENRES = {
      10759: { name: 'Action & Adventure', icon: '🎬' },
      16: { name: 'Animation', icon: '🎨' },
      35: { name: 'Comedy', icon: '😂' },
      80: { name: 'Crime', icon: '🚔' },
      99: { name: 'Documentary', icon: '📚' },
      18: { name: 'Drama', icon: '🎭' },
      10751: { name: 'Family', icon: '👨‍👩‍👧‍👦' },
      10762: { name: 'Kids', icon: '🧒' },
      9648: { name: 'Mystery', icon: '🔍' },
      10763: { name: 'News', icon: '📰' },
      10764: { name: 'Reality', icon: '📷' },
      10765: { name: 'Sci-Fi & Fantasy', icon: '🚀' },
      10766: { name: 'Soap', icon: '📺' },
      10767: { name: 'Talk', icon: '💬' },
      10768: { name: 'War & Politics', icon: '⚔️' },
      37: { name: 'Western', icon: '🤠' }
    };

    let displayedMediaIds = new Set();

    let currentMoviePage = 1;
    let currentTvPage = 1;
    let isLoadingMore = false;
    let currentMovieEndpoint = '/movie/popular';
    let currentTvEndpoint = '/tv/popular';

    let currentLanguage = 'es-419'; // Spanish (Latin America)
    let currentMediaType = 'movie';
    let isLoading = false;
    let advancedSearchParams = null;
    let isAdvancedSearchActive = false;

    window.currentFilter = 'all';
    window.currentGenreId = null;

    function displayCategories(type) {
      const categoryGrid = document.querySelector('.category-grid');
      categoryGrid.innerHTML = '';

      const genres = type === 'movie' ? MOVIE_GENRES : TV_GENRES;
      
      Object.entries(genres).forEach(([id, {name, icon}]) => {
        const categoryCard = document.createElement('div');
        categoryCard.className = 'category-card';
        categoryCard.onclick = () => filterByGenre(id, type);

        categoryCard.innerHTML = `
          <div class="category-background"></div>
          <div class="category-backdrop"></div>
          <div class="category-content">
            <div class="category-icon">${icon}</div>
            <h3>${name}</h3>
          </div>
        `;

        categoryGrid.appendChild(categoryCard);
      });
    }

    function updateCategoriesSection() {
      // Add category toggle functionality
      const movieCategoriesBtn = document.getElementById('movieCategoriesBtn');
      const tvCategoriesBtn = document.getElementById('tvCategoriesBtn');

      if (movieCategoriesBtn && tvCategoriesBtn) {
        movieCategoriesBtn.addEventListener('click', () => {
          movieCategoriesBtn.classList.add('active');
          tvCategoriesBtn.classList.remove('active');
          displayCategories('movie');
        });

        tvCategoriesBtn.addEventListener('click', () => {
          tvCategoriesBtn.classList.add('active');
          movieCategoriesBtn.classList.remove('active');
          displayCategories('tv');
        });
      }
    }

    async function filterByGenre(genreId, type) {
      try {
        const endpoint = type === 'movie' ? '/discover/movie' : '/discover/tv';
        const results = await fetchMedia(endpoint, { 
          with_genres: genreId,
          page: 1 
        });

        const grid = type === 'movie' ? 
          document.querySelector('.movies-grid') : 
          document.querySelector('.tv-grid');

        grid.innerHTML = '';
        displayedMediaIds.clear();

        if (results.length === 0) {
          grid.innerHTML = '<div class="error">No content found for this category</div>';
        } else {
          results.forEach(item => displayMediaItem(item, grid, type));
        }

        // Scroll to the results
        grid.scrollIntoView({ behavior: 'smooth' });

      } catch (error) {
        console.error('Error filtering by genre:', error);
        const grid = type === 'movie' ? 
          document.querySelector('.movies-grid') : 
          document.querySelector('.tv-grid');
        grid.innerHTML = '<div class="error">Error loading category content. Please try again.</div>';
      }
    }

    async function fetchSimilarContent(id, type) {
      try {
        // Fetch both similar content and collection info in parallel
        const [similarResponse, collectionResponse] = await Promise.all([
          fetch(`${TMDB_BASE_URL}/${type}/${id}/similar?api_key=${TMDB_API_KEY}&language=${currentLanguage}`),
          type === 'movie' ? 
            fetch(`${TMDB_BASE_URL}/${type}/${id}?api_key=${TMDB_API_KEY}&language=${currentLanguage}&append_to_response=belongs_to_collection`) :
            fetch(`${TMDB_BASE_URL}/${type}/${id}?api_key=${TMDB_API_KEY}&language=${currentLanguage}`)
        ]);

        const similarData = await similarResponse.json();
        const contentData = await collectionResponse.json();
        
        let collectionItems = [];
        if (type === 'movie' && contentData.belongs_to_collection) {
          // If it belongs to a collection, fetch the collection details
          const collectionResponse = await fetch(
            `${TMDB_BASE_URL}/collection/${contentData.belongs_to_collection.id}?api_key=${TMDB_API_KEY}&language=${currentLanguage}`
          );
          const collectionData = await collectionResponse.json();
          collectionItems = collectionData.parts || [];
        }

        return {
          similar: similarData.results || [],
          collection: collectionItems
        };
      } catch (error) {
        console.error('Error fetching similar content:', error);
        return { similar: [], collection: [] };
      }
    }

    async function searchTrailer(title, type, year) {
      try {
        const YOUTUBE_API_KEY = 'YOUR_YOUTUBE_API_KEY'; // You'll need to add a YouTube API key
        // Format search query
        const searchQuery = encodeURIComponent(`${title} ${year} trailer español latino`);
        
        // First try TrailersInSpanish channel
        const channelId = 'UCeYZvxQ9E_UXhGEk6klKxXg'; // TrailersInSpanish channel ID
        let response = await fetch(
          `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&q=${searchQuery}&key=${YOUTUBE_API_KEY}&type=video&maxResults=1`
        );
        let data = await response.json();
        
        // If no results in TrailersInSpanish, search all of YouTube
        if (!data.items || data.items.length === 0) {
          response = await fetch(
            `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${searchQuery}&key=${YOUTUBE_API_KEY}&type=video&maxResults=1`
          );
          data = await response.json();
        }
        
        if (data.items && data.items.length > 0) {
          return `https://www.youtube.com/embed/${data.items[0].id.videoId}`;
        }
        
        throw new Error('No trailer found');
      } catch (error) {
        console.error('Error searching for trailer:', error);
        throw error;
      }
    }

    async function playTrailer(id, type) {
      try {
        // Get media details from TMDB
        const response = await fetch(
          `${TMDB_BASE_URL}/${type}/${id}?api_key=${TMDB_API_KEY}&language=${currentLanguage}`
        );
        const data = await response.json();
        
        const videoContainer = document.querySelector('.video-container');
        videoContainer.innerHTML = '<div class="loading">Buscando trailer...</div>';
        
        try {
          // First try to get trailer from YouTube
          const trailerUrl = await searchTrailer(
            data.title || data.name,
            type,
            (data.release_date || data.first_air_date || '').split('-')[0]
          );
          
          videoContainer.innerHTML = `
            <iframe 
              id="player" 
              src="${trailerUrl}" 
              frameborder="0" 
              allowfullscreen>
            </iframe>
          `;
        } catch (youtubeError) {
          // If YouTube search fails, try TMDB videos as fallback
          const videosResponse = await fetch(
            `${TMDB_BASE_URL}/${type}/${id}/videos?api_key=${TMDB_API_KEY}`
          );
          const videos = await videosResponse.json();
          
          const trailer = videos.results.find(video => 
            video.type === 'Trailer' && 
            (video.site === 'YouTube' || video.site === 'Vimeo')
          );
          
          if (trailer) {
            const trailerUrl = trailer.site === 'YouTube' 
              ? `https://www.youtube.com/embed/${trailer.key}`
              : `https://player.vimeo.com/video/${trailer.key}`;
              
            videoContainer.innerHTML = `
              <iframe 
                id="player" 
                src="${trailerUrl}" 
                frameborder="0" 
                allowfullscreen>
              </iframe>
            `;
          } else {
            throw new Error('No trailer available');
          }
        }
        
      } catch (error) {
        console.error('Error playing trailer:', error);
        const videoContainer = document.querySelector('.video-container');
        videoContainer.innerHTML = `
          <div class="error">
            No se pudo encontrar el trailer. 
            <button onclick="closeVideo()" class="retry-button">Cerrar</button>
          </div>
        `;
      }
    }

    async function playMedia(server = 'latino', id, type) {
      try {
        // For Latino server, we need to verify the content exists in Spanish
        if (server === 'latino') {
          fetch(`${TMDB_BASE_URL}/${type}/${id}?api_key=${TMDB_API_KEY}&language=es-419`)
            .then(response => response.json())
            .then(data => {
              if (!data || data.success === false) {
                console.log('Content not available in Latino server, falling back to server1');
                // If content not available in Latino, fall back to server1
                playMedia('server1', id, type);
                return;
              }
              
              currentServer = server;
              const videoContainer = document.querySelector('.video-container');
              const player = document.getElementById('player');
              
              // Show loading state
              videoContainer.innerHTML = `
                <div class="loading">Cargando video...</div>
                <iframe id="player" frameborder="0" allowfullscreen></iframe>
              `;

              // Get updated player reference
              const newPlayer = document.getElementById('player');
              
              // Construct video URL based on server and media type
              const videoUrl = constructVideoUrl(server, id, type);
              console.log('Loading video from:', videoUrl);
              
              // Add loading event listeners
              newPlayer.onload = () => {
                const loadingDiv = videoContainer.querySelector('.loading');
                if (loadingDiv) loadingDiv.remove();
                newPlayer.style.display = 'block';
              };

              newPlayer.onerror = () => {
                console.error('Failed to load video');
                playMedia('server1', id, type); // Try server1 if Latino fails
              };

              // Set video source
              newPlayer.src = videoUrl;
            })
            .catch(error => {
              console.error('Error checking Latino content:', error);
              playMedia('server1', id, type); // Fall back to server1
            });
        } else {
          // Handle non-Latino servers as before
          currentServer = server;
          const videoContainer = document.querySelector('.video-container');
          const player = document.getElementById('player');
          
          // Show loading state
          videoContainer.innerHTML = `
            <div class="loading">Cargando video...</div>
            <iframe id="player" frameborder="0" allowfullscreen></iframe>
          `;

          // Get updated player reference
          const newPlayer = document.getElementById('player');
          
          // Construct video URL based on server and media type
          const videoUrl = constructVideoUrl(server, id, type);
          
          // Add loading event listeners
          newPlayer.onload = () => {
            const loadingDiv = videoContainer.querySelector('.loading');
            if (loadingDiv) loadingDiv.remove();
            newPlayer.style.display = 'block';
          };

          newPlayer.onerror = () => {
            console.error('Failed to load video');
            videoContainer.innerHTML = `
              <div class="error">
                Error al cargar el video. Por favor intente con otro servidor.
                <button onclick="playMedia('server1', id, type)" class="retry-button">
                  Intentar con Servidor 1
                </button>
              </div>
            `;
          };

          // Set video source
          newPlayer.src = videoUrl;
        }

      } catch (error) {
        console.error('Error playing media:', error);
        if (server === 'latino') {
          // If Latino server errors, try server1
          playMedia('server1', id, type);
        } else {
          const videoContainer = document.querySelector('.video-container');
          videoContainer.innerHTML = `
            <div class="error">
              ${error.message || 'Error al cargar el video. Por favor intente otro servidor.'}
              <button onclick="playMedia('server1', '${id}', '${type}')" class="retry-button">
                Intentar con Servidor 1
              </button>
            </div>
          `;
        }
      }
    }

    async function openMediaDetails(id, type) {
      try {
        currentMediaId = id;
        previousMediaId = id;
        previousMediaType = type;
        
        const modal = document.getElementById('playerModal');
        const mediaInfo = document.getElementById('mediaInfo');
        const seasonEpisodeSelection = document.getElementById('seasonEpisodeSelection');
        
        mediaInfo.innerHTML = '<div class="loading">Loading details...</div>';
        modal.style.display = 'block';

        const response = await fetch(
          `${TMDB_BASE_URL}/${type}/${id}?api_key=${TMDB_API_KEY}&language=${currentLanguage}`
        );
        const data = await response.json();

        let tvShowSelectionHtml = '';
        if (type === 'tv') {
          // Add season/episode selection for TV shows
          tvShowSelectionHtml = `
            <div id="seasonEpisodeSelection" style="margin: 20px 0; padding: 15px; background: rgba(35,35,35,0.95); border-radius: 8px;">
              <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                  <label for="seasonSelect" style="display: block; margin-bottom: 8px;">Temporada:</label>
                  <select id="seasonSelect" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); color: white; border: 1px solid rgba(255,255,255,0.2); border-radius: 4px;">
                    ${Array.from({length: data.number_of_seasons}, (_, i) => i + 1)
                      .map(num => `<option value="${num}">Temporada ${num}</option>`)
                      .join('')}
                  </select>
                </div>
                <div style="flex: 1; min-width: 200px;">
                  <label for="episodeSelect" style="display: block; margin-bottom: 8px;">Episodio:</label>
                  <select id="episodeSelect" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); color: white; border: 1px solid rgba(255,255,255,0.2); border-radius: 4px;">
                    <!-- Episodes will be loaded dynamically -->
                  </select>
                </div>
                <div style="flex: 1; min-width: 200px;">
                  <label for="subtitleSelect" style="display: block; margin-bottom: 8px;">Subtítulos:</label>
                  <select id="subtitleSelect" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); color: white; border: 1px solid rgba(255,255,255,0.2); border-radius: 4px;">
                    <option value="off">Sin subtítulos</option>
                    <option value="es">Español</option>
                    <option value="en">English</option>
                  </select>
                </div>
              </div>
            </div>
          `;
        }

        const playButtonsHtml = `
          <div class="play-buttons">
            <button onclick="playMedia('latino', '${id}', '${type}')" class="play-button latino-server active">
              🌎 Server Latino (PlayHubLite)
            </button>
            <button onclick="playMedia('server1', '${id}', '${type}')" class="play-button">
              Server 1 (VidSrc.to)
            </button>
            <button onclick="playMedia('moviesapi', '${id}', '${type}')" class="play-button">
              Server 2 (MultiEmbed)
            </button>
            <button onclick="playMedia('vidsrc', '${id}', '${type}')" class="play-button">
              Server 3 (VidSrc.me)
            </button>
            <button onclick="playMedia('moviesapiclub', '${id}', '${type}')" class="play-button">
              Server 4 (MoviesAPI.club)
            </button>
            <button onclick="playMedia('vidsrcxyz', '${id}', '${type}')" class="play-button">
              Server 5 (VidSrc.xyz)
            </button>
            <button onclick="playTrailer('${id}', '${type}')" class="trailer-button">
              Ver Trailer
            </button>
          </div>
        `;

        let contentHtml = `
          <div class="video-container">
            <iframe id="player" frameborder="0" allowfullscreen></iframe>
            <div class="player-controls">
              <button onclick="closeVideo()" class="close-video">Close Video</button>
            </div>
          </div>

          ${tvShowSelectionHtml}

          <h2>${data.title || data.name}</h2>
          <div class="media-details-info">
            <p><strong>Rating:</strong> ⭐ ${data.vote_average?.toFixed(1) || 'N/A'}</p>
            <p><strong>Release Date:</strong> ${data.release_date || data.first_air_date || 'N/A'}</p>
            <p><strong>Overview:</strong> ${data.overview || 'No overview available.'}</p>
          </div>
          ${playButtonsHtml}

          <div class="similar-content-section">
            <h3>Contenido Relacionado</h3>
            <div class="similar-media-grid" id="similarContent">
              <div class="loading">Cargando contenido relacionado...</div>
            </div>
          </div>
        `;

        mediaInfo.innerHTML = contentHtml;

        // Load similar content
        fetchSimilarContent(id, type).then(({similar, collection}) => {
          const similarContentGrid = document.getElementById('similarContent');
          similarContentGrid.innerHTML = '';

          // Display collection items first if they exist
          if (collection.length > 0) {
            const collectionTitle = document.createElement('h4');
            collectionTitle.textContent = 'Saga / Colección';
            collectionTitle.style.margin = '10px 0';
            collectionTitle.style.color = '#e50914';
            similarContentGrid.appendChild(collectionTitle);

            collection.forEach(item => {
              if (item.id !== parseInt(id)) { // Don't show current item
                const similarDiv = createSimilarItemElement(item, type);
                similarContentGrid.appendChild(similarDiv);
              }
            });
          }

          // Display similar content
          if (similar.length > 0) {
            const similarTitle = document.createElement('h4');
            similarTitle.textContent = 'Títulos Similares';
            similarTitle.style.margin = '20px 0 10px 0';
            similarTitle.style.color = '#e50914';
            similarContentGrid.appendChild(similarTitle);

            similar.slice(0, 6).forEach(item => {
              const similarDiv = createSimilarItemElement(item, type);
              similarContentGrid.appendChild(similarDiv);
            });
          }

          if (collection.length === 0 && similar.length === 0) {
            similarContentGrid.innerHTML = '<p>No se encontró contenido relacionado</p>';
          }
        });

        // If it's a TV show, load the episodes for the first season
        if (type === 'tv') {
          loadEpisodes(id, 1);
          
          // Add event listener for season change
          document.getElementById('seasonSelect').addEventListener('change', function() {
            loadEpisodes(id, this.value);
          });
        }

      } catch (error) {
        console.error('Error opening media details:', error);
        document.getElementById('mediaInfo').innerHTML = 
          '<div class="error">Error loading media details. Please try again.</div>';
      }
    }

    function createSimilarItemElement(item, type) {
      const similarDiv = document.createElement('div');
      similarDiv.className = 'similar-item';
      similarDiv.onclick = () => openMediaDetails(item.id, type);

      const posterUrl = item.poster_path ? 
        `https://image.tmdb.org/t/p/w200${item.poster_path}` :
        'path/to/placeholder-image.jpg';

      const rating = item.vote_average ? item.vote_average.toFixed(1) : 'N/A';
      const year = (item.release_date || item.first_air_date || '').split('-')[0];

      similarDiv.innerHTML = `
        <div class="rating-badge">⭐ ${rating}</div>
        <div class="media-year">${year}</div>
        <img src="${posterUrl}" alt="${item.title || item.name}" loading="lazy">
        <p>${item.title || item.name}</p>
      `;

      return similarDiv;
    }

    async function loadEpisodes(showId, seasonNumber) {
      try {
        const response = await fetch(
          `${TMDB_BASE_URL}/tv/${showId}/season/${seasonNumber}?api_key=${TMDB_API_KEY}&language=${currentLanguage}`
        );
        const data = await response.json();
        
        const episodeSelect = document.getElementById('episodeSelect');
        episodeSelect.innerHTML = data.episodes
          .map(episode => `
            <option value="${episode.episode_number}">
              Episodio ${episode.episode_number}: ${episode.name}
            </option>
          `)
          .join('');

        // Add event listener to update video when episode changes
        episodeSelect.addEventListener('change', function() {
          const server = currentServer || 'latino';
          playMedia(server, currentMediaId, 'tv');
        });
      } catch (error) {
        console.error('Error loading episodes:', error);
      }
    }

    async function fetchMedia(endpoint, params = {}) {
      try {
        const response = await axios.get(`${TMDB_BASE_URL}${endpoint}`, {
          params: {
            api_key: TMDB_API_KEY,
            language: currentLanguage,
            page: params.page || 1,
            ...params
          }
        });
        
        if (response.data && response.data.results) {
          return response.data.results.filter(item => item.poster_path != null);
        }
        console.error('Invalid response format:', response.data);
        return [];
      } catch (error) {
        console.error(`Error fetching media from ${endpoint}:`, error);
        return [];
      }
    }

    async function loadMoreContent(type) {
      // Prevent multiple simultaneous loads
      if (isLoadingMore) return;
      isLoadingMore = true;

      try {
        // Get the appropriate grid and page number
        const grid = type === 'movie' ? 
          document.querySelector('.movies-grid') : 
          document.querySelector('.tv-grid');
        
        const page = type === 'movie' ? ++currentMoviePage : ++currentTvPage;
        const endpoint = type === 'movie' ? currentMovieEndpoint : currentTvEndpoint;
        
        // Update loading button state
        const loadMoreButton = type === 'movie' ? 
          document.getElementById('loadMoreMovies') : 
          document.getElementById('loadMoreTv');
        loadMoreButton.textContent = 'Loading...';
        loadMoreButton.disabled = true;

        // Fetch next page of content
        const results = await fetchMedia(endpoint, { page });

        if (results.length > 0) {
          // Display new items
          results.forEach(item => displayMediaItem(item, grid, type));
          
          // Re-enable load more button
          loadMoreButton.textContent = type === 'movie' ? 
            'Cargar más películas' : 
            'Cargar más series';
          loadMoreButton.disabled = false;
        } else {
          // No more content to load
          loadMoreButton.textContent = 'No hay más contenido';
          loadMoreButton.disabled = true;
        }

      } catch (error) {
        console.error(`Error loading more ${type} content:`, error);
        const loadMoreButton = type === 'movie' ? 
          document.getElementById('loadMoreMovies') : 
          document.getElementById('loadMoreTv');
        loadMoreButton.textContent = 'Error - Intentar de nuevo';
        loadMoreButton.disabled = false;
      }

      isLoadingMore = false;
    }

    async function fetchSubtitles(imdbId, language = 'es') {
      try {
        const response = await fetch(`${OPENSUBTITLES_API_URL}/subtitles`, {
          method: 'GET',
          headers: {
            'Api-Key': OPENSUBTITLES_API_KEY,
            'User-Agent': USER_AGENT,
            'Content-Type': 'application/json'
          },
          params: {
            imdb_id: imdbId,
            languages: language,
            order_by: 'download_count', // Get most popular subtitles first
            order_direction: 'desc'
          }
        });
        
        const data = await response.json();
        return data.data.filter(sub => 
          // Prioritize Spanish (Latin American) and Spanish (Spain) subtitles
          sub.attributes.language === 'es-419' || 
          sub.attributes.language === 'es-ES' ||
          sub.attributes.language === 'es'
        ).slice(0, 5); // Get top 5 Spanish subtitles
      } catch (error) {
        console.error('Error fetching subtitles:', error);
        return null;
      }
    }

    function displayMediaItem(item, container, type) {
      if (!item.poster_path) return;
      
      const mediaDiv = document.createElement('div');
      mediaDiv.className = 'media-item';
      mediaDiv.onclick = () => openMediaDetails(item.id, type);

      const posterUrl = `https://image.tmdb.org/t/p/w500${item.poster_path}`;
      const rating = item.vote_average ? item.vote_average.toFixed(1) : 'N/A';
      const year = (item.release_date || item.first_air_date || '').split('-')[0];

      mediaDiv.innerHTML = `
        <div class="rating-badge">⭐ ${rating}</div>
        <div class="media-year">${year}</div>
        <img 
          src="${posterUrl}" 
          alt="${item.title || item.name}"
          loading="lazy"
        >
      `;

      if (!displayedMediaIds.has(item.id)) {
        displayedMediaIds.add(item.id);
        container.appendChild(mediaDiv);
      }
    }

    async function loadInitialContent() {
      try {
        console.log('Loading initial content...');
        currentMoviePage = 1;
        currentTvPage = 1;
        displayedMediaIds.clear();

        // Show both sections by default
        document.querySelector('.movies-section').style.display = 'block';
        document.querySelector('.tv-section').style.display = 'block';

        // Fetch popular movies and TV shows
        const [movies, tvShows] = await Promise.all([
          fetchMedia('/movie/popular', { page: 1 }),
          fetchMedia('/tv/popular', { page: 1 })
        ]);

        // Clear existing content
        const moviesGrid = document.querySelector('.movies-grid');
        const tvGrid = document.querySelector('.tv-grid');
        moviesGrid.innerHTML = '';
        tvGrid.innerHTML = '';

        // Display movies
        movies.forEach(movie => displayMediaItem(movie, moviesGrid, 'movie'));
        
        // Display TV shows
        tvShows.forEach(show => displayMediaItem(show, tvGrid, 'tv'));

        // Reset load more buttons
        const loadMoreMovies = document.getElementById('loadMoreMovies');
        const loadMoreTv = document.getElementById('loadMoreTv');
        if (loadMoreMovies) {
          loadMoreMovies.disabled = false;
          loadMoreMovies.textContent = 'Cargar más películas';
        }
        if (loadMoreTv) {
          loadMoreTv.disabled = false;
          loadMoreTv.textContent = 'Cargar más series';
        }
      } catch (error) {
        console.error('Error in loadInitialContent:', error);
        document.querySelector('.movies-grid').innerHTML = 
          '<div class="error">Error loading movies. Please try again.</div>';
        document.querySelector('.tv-grid').innerHTML = 
          '<div class="error">Error loading TV shows. Please try again.</div>';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Show both sections by default
      document.querySelector('.movies-section').style.display = 'block';
      document.querySelector('.tv-section').style.display = 'block';

      // Call loadInitialContent to load both movies and TV shows
      loadInitialContent();

      // Update categories section
      updateCategoriesSection();
      displayCategories('movie'); // Start with movie categories
    });

    const closeButton = document.querySelector('.close');
    if (closeButton) {
      closeButton.addEventListener('click', closeModal);
    }

    const modal = document.getElementById('playerModal');
    if (modal) {
      window.addEventListener('click', (event) => {
        if (event.target === modal) {
          closeModal();
        }
      });
    }

    // Add load more event listeners
    document.getElementById('loadMoreMovies')?.addEventListener('click', () => loadMoreContent('movie'));
    document.getElementById('loadMoreTv')?.addEventListener('click', () => loadMoreContent('tv'));
    
    // Modify the navigation buttons to update currentEndpoints
    const buttons = {
      'popularButton': { movie: '/movie/popular', tv: '/tv/popular' },
      'nowPlayingButton': { movie: '/movie/now_playing', tv: '/tv/on_the_air' },
      'topRatedButton': { movie: '/movie/top_rated', tv: '/tv/top_rated' }
    };
    
    Object.entries(buttons).forEach(([buttonId, endpoints]) => {
      document.getElementById(buttonId)?.addEventListener('click', () => {
        currentMovieEndpoint = endpoints.movie;
        currentTvEndpoint = endpoints.tv;
        currentMoviePage = 1;
        currentTvPage = 1;
      });
    });

    // Add search functionality
    document.getElementById('searchButton')?.addEventListener('click', async function() {
      const searchQuery = document.getElementById('searchInput').value.trim();
      if (!searchQuery) return;

      try {
        const moviesGrid = document.querySelector('.movies-grid');
        const tvGrid = document.querySelector('.tv-grid');

        moviesGrid.innerHTML = '<div class="loading">Searching movies...</div>';
        tvGrid.innerHTML = '<div class="loading">Searching TV shows...</div>';

        const [movies, tvShows] = await Promise.all([
          fetchMedia('/search/movie', { query: searchQuery }),
          fetchMedia('/search/tv', { query: searchQuery })
        ]);

        displayedMediaIds.clear();
        moviesGrid.innerHTML = '';
        tvGrid.innerHTML = '';

        if (movies.length === 0) {
          moviesGrid.innerHTML = '<div class="error">No movies found</div>';
        } else {
          movies.forEach(movie => displayMediaItem(movie, moviesGrid, 'movie'));
        }

        if (tvShows.length === 0) {
          tvGrid.innerHTML = '<div class="error">No TV shows found</div>';
        } else {
          tvShows.forEach(show => displayMediaItem(show, tvGrid, 'tv'));
        }

      } catch (error) {
        console.error('Search error:', error);
        document.querySelector('.movies-grid').innerHTML = 
          '<div class="error">Error searching movies. Please try again.</div>';
        document.querySelector('.tv-grid').innerHTML = 
          '<div class="error">Error searching TV shows. Please try again.</div>';
      }
    });

    // Add Enter key support for search
    document.getElementById('searchInput')?.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        document.getElementById('searchButton').click();
      }
    });
  </script>
  <footer>
    <strong>Design by Victor</strong>
  </footer>
</body></html>